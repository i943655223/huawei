"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}new(function(){function r(t,e){_classCallCheck(this,r),this.container=document.getElementById(t),this.products=e,this.cartProducts=this.getStorage()||[],this.shopList=document.createElement("table"),this.cartList=document.createElement("table"),this.container.appendChild(this.shopList),this.container.appendChild(this.cartList)}return _createClass(r,[{key:"setStorage",value:function(t){localStorage.setItem("cart",JSON.stringify(t))}},{key:"getStorage",value:function(){return JSON.parse(localStorage.getItem("cart"))||[]}},{key:"init",value:function(){this.initShopList(),0<this.getStorage().length&&this.rendCartList()}},{key:"initShopList",value:function(){var t="<thead><tr><th>华为专卖</th><th></th><th>单价</th><th>操作</th></tr></thead>";t+="<tbody>";for(var e=0;e<this.products.length;e++)t+='<tr><td class="box" ><div class="small"><img src="'+this.products[e].pic+'"><div class="mask"><img src="'+this.products[e].pic+'"></div><div class="bg"></div></div><div class="big"><img src="'+this.products[e].pic+'" class="bigImg"></div></td><td>'+this.products[e].name+"</td><td>"+this.products[e].price+'</td><td><a href="javascript:;" class="addCart">加入购物车</a></td></tr>';t+="</tbody>",this.shopList.innerHTML=t,this.addCartListEvent()}},{key:"addCartListEvent",value:function(){var r=this;document.querySelectorAll(".addCart").forEach(function(t){t.onclick=function(){var t=this.parentNode.parentNode,e={pic:t.children[0].children[0].children[0].src,name:t.children[1].innerHTML,price:t.children[2].innerHTML};r.addToCartProducts(e),r.rendCartList()}})}},{key:"addToCartProducts",value:function(t){this.cartProducts=this.getStorage();for(var e=0;e<this.cartProducts.length;e++)if(this.cartProducts[e].name===t.name)return this.cartProducts[e].num++,void this.setStorage(this.cartProducts);t.num=1,this.cartProducts.push(t),this.setStorage(this.cartProducts),this.rendCartList()}},{key:"rendCartList",value:function(){var t="<thead><tr><th>华为专卖</th><th></th><th>数量</th><th>操作</th></tr></thead>";t+="<tbody>";for(var e=0;e<this.getStorage().length;e++)t+='<tr><td><img src="'+this.getStorage()[e].pic+'"></td><td>'+this.getStorage()[e].name+'</td><td class="change"><span class="jian">-</span>'+this.getStorage()[e].num+'<span class="jia">+</span></td><td><a href="javascript:;" class="del">删除</a></td></tr>';t+="</tbody>",this.cartList.innerHTML=t,this.delEvent(),this.changeNum()}},{key:"delEvent",value:function(){var e=this;this.container.querySelectorAll(".del").forEach(function(t){t.onclick=function(){var t=this.parentNode.parentNode.children[1].innerHTML;e.delFromCartProducts(t)}})}},{key:"delFromCartProducts",value:function(e){this.cartProducts=this.getStorage(),this.cartProducts=this.cartProducts.filter(function(t){return t.name!==e}),this.setStorage(this.cartProducts),this.rendCartList(),this.cartProducts.length<1&&(this.cartList.innerHTML="")}},{key:"changeNum",value:function(){var i=this;this.container.querySelectorAll(".change").forEach(function(t){t.onclick=function(t){var e=(t=window.event||t).target||t.srcElement,r=this.parentNode.children[1].innerHTML;"jian"==e.className&&i.jianNum(r),"jia"==e.className&&i.jiaNum(r)}})}},{key:"jianNum",value:function(t){this.cartProducts=this.getStorage();for(var e=0;e<this.cartProducts.length;e++)if(this.cartProducts[e].name===t)return this.cartProducts[e].num--,this.setStorage(this.cartProducts),this.rendCartList(),this.cartProducts[e].num<=0?void this.delFromCartProducts(t):void 0}},{key:"jiaNum",value:function(t){this.cartProducts=this.getStorage();for(var e=0;e<this.cartProducts.length;e++)if(this.cartProducts[e].name===t)return this.cartProducts[e].num++,this.setStorage(this.cartProducts),void this.rendCartList()}}]),r}())("cart",[{name:"HUAWEI Mate 30 4G",pic:"../images/shouji1.png",price:"¥4299"},{name:"HUAWEI nova 5z",pic:"../images/shouji2.png",price:"¥1399"},{name:"荣耀20i",pic:"../images/shouji3.png",price:"¥1099"}]).init(),$(function(){$.ajax({url:"./server.php",success:function(t){"1"==t&&($(".weidenglu").html(""),$(".yidenglu").css({display:"block"}).children(".us").html(function(t){for(var e=document.cookie.split("; "),r=0;r<e.length;r++){var i=e[r].split("=");if(i[0]==t)return i[1]}}("username")))}})})();